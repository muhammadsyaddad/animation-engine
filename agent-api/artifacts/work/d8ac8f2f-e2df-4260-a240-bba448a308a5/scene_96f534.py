from manim import *
from math import *
config.frame_size = (1280, 720)
config.frame_width = 10.0

from manim import *
import math

# Embedded histogram data
TIMES = ['1800', '1801', '1802', '1803', '1804', '1805', '1806', '1807', '1808', '1809', '1810', '1811', '1812', '1813', '1814', '1815', '1816', '1817', '1818', '1819', '1820', '1821', '1822', '1823', '1824', '1825', '1826', '1827', '1828', '1829', '1830', '1831', '1832', '1833', '1834', '1835', '1836', '1837', '1838', '1839', '1840', '1841', '1842', '1843', '1844', '1845', '1846', '1847', '1848', '1849', '1850', '1851', '1852', '1853', '1854', '1855', '1856', '1857', '1858', '1859', '1860', '1861', '1862', '1863', '1864', '1865', '1866', '1867', '1868', '1869', '1870', '1871', '1872', '1873', '1874', '1875', '1876', '1877', '1878', '1879', '1880', '1881', '1882', '1883', '1884', '1885', '1886', '1887', '1888', '1889', '1890', '1891', '1892', '1893', '1894', '1895', '1896', '1897', '1898', '1899', '1900', '1901', '1902', '1903', '1904', '1905', '1906', '1907', '1908', '1909', '1910', '1911', '1912', '1913', '1914', '1915', '1916', '1917', '1918', '1919', '1920', '1921', '1922', '1923', '1924', '1925', '1926', '1927', '1928', '1929', '1930', '1931', '1932', '1933', '1934', '1935', '1936', '1937', '1938', '1939', '1940', '1941', '1942', '1943', '1944', '1945', '1946', '1947', '1948', '1949', '1950', '1951', '1952', '1953', '1954', '1955', '1956', '1957', '1958', '1959', '1960', '1961', '1962', '1963', '1964', '1965', '1966', '1967', '1968', '1969', '1970', '1971', '1972', '1973', '1974', '1975', '1976', '1977', '1978', '1979', '1980', '1981', '1982', '1983', '1984', '1985', '1986', '1987', '1988', '1989', '1990', '1991', '1992', '1993', '1994', '1995', '1996', '1997', '1998', '1999', '2000', '2001', '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014', '2015', '2016', '2017', '2018']
BIN_EDGES = [1.0, 9.32, 17.64, 25.96, 34.28, 42.6, 50.92, 59.24, 67.56, 75.88, 84.2]
BIN_LABELS = ['1.00-9.32', '9.32-17.64', '17.64-25.96', '25.96-34.28', '34.28-42.60', '42.60-50.92', '50.92-59.24', '59.24-67.56', '67.56-75.88', '75.88-84.20']
HISTS = {'1800': [0, 0, 19, 125, 39, 1, 0, 0, 0, 0], '1801': [0, 0, 20, 123, 41, 0, 0, 0, 0, 0], '1802': [0, 0, 20, 123, 40, 1, 0, 0, 0, 0], '1803': [0, 0, 20, 125, 38, 1, 0, 0, 0, 0], '1804': [0, 0, 20, 124, 39, 1, 0, 0, 0, 0], '1805': [0, 0, 19, 125, 38, 2, 0, 0, 0, 0], '1806': [0, 0, 19, 124, 37, 4, 0, 0, 0, 0], '1807': [0, 0, 19, 124, 39, 2, 0, 0, 0, 0], '1808': [0, 1, 19, 124, 39, 1, 0, 0, 0, 0], '1809': [0, 1, 19, 125, 39, 0, 0, 0, 0, 0], '1810': [0, 0, 19, 124, 40, 1, 0, 0, 0, 0], '1811': [0, 0, 19, 124, 41, 0, 0, 0, 0, 0], '1812': [0, 0, 19, 125, 39, 1, 0, 0, 0, 0], '1813': [0, 0, 19, 127, 37, 1, 0, 0, 0, 0], '1814': [0, 0, 19, 124, 41, 0, 0, 0, 0, 0], '1815': [0, 0, 19, 122, 40, 3, 0, 0, 0, 0], '1816': [0, 0, 19, 123, 40, 2, 0, 0, 0, 0], '1817': [0, 0, 19, 122, 40, 3, 0, 0, 0, 0], '1818': [1, 0, 19, 121, 40, 3, 0, 0, 0, 0], '1819': [1, 0, 19, 121, 41, 2, 0, 0, 0, 0], '1820': [1, 0, 19, 121, 40, 3, 0, 0, 0, 0], '1821': [0, 0, 19, 123, 41, 1, 0, 0, 0, 0], '1822': [0, 0, 19, 122, 39, 4, 0, 0, 0, 0], '1823': [0, 0, 19, 122, 39, 4, 0, 0, 0, 0], '1824': [0, 0, 19, 122, 40, 3, 0, 0, 0, 0], '1825': [0, 0, 19, 123, 39, 3, 0, 0, 0, 0], '1826': [0, 0, 20, 122, 40, 2, 0, 0, 0, 0], '1827': [0, 0, 20, 122, 40, 2, 0, 0, 0, 0], '1828': [0, 0, 19, 123, 41, 1, 0, 0, 0, 0], '1829': [0, 0, 19, 123, 41, 1, 0, 0, 0, 0], '1830': [0, 0, 19, 123, 40, 2, 0, 0, 0, 0], '1831': [0, 0, 19, 123, 41, 1, 0, 0, 0, 0], '1832': [0, 0, 19, 124, 40, 1, 0, 0, 0, 0], '1833': [0, 0, 20, 121, 42, 1, 0, 0, 0, 0], '1834': [0, 0, 20, 122, 42, 0, 0, 0, 0, 0], '1835': [0, 0, 19, 122, 41, 2, 0, 0, 0, 0], '1836': [0, 0, 19, 124, 39, 2, 0, 0, 0, 0], '1837': [0, 0, 19, 123, 41, 1, 0, 0, 0, 0], '1838': [0, 0, 19, 123, 40, 2, 0, 0, 0, 0], '1839': [0, 0, 20, 122, 40, 2, 0, 0, 0, 0], '1840': [0, 0, 19, 122, 41, 2, 0, 0, 0, 0], '1841': [0, 0, 20, 119, 42, 3, 0, 0, 0, 0], '1842': [0, 0, 20, 119, 43, 2, 0, 0, 0, 0], '1843': [0, 0, 20, 120, 41, 3, 0, 0, 0, 0], '1844': [0, 1, 19, 119, 41, 4, 0, 0, 0, 0], '1845': [0, 0, 20, 119, 40, 5, 0, 0, 0, 0], '1846': [0, 0, 21, 120, 42, 1, 0, 0, 0, 0], '1847': [0, 0, 20, 121, 42, 1, 0, 0, 0, 0], '1848': [0, 1, 20, 118, 43, 2, 0, 0, 0, 0], '1849': [0, 2, 20, 118, 42, 2, 0, 0, 0, 0], '1850': [0, 2, 19, 120, 38, 5, 0, 0, 0, 0], '1851': [0, 0, 20, 119, 42, 3, 0, 0, 0, 0], '1852': [0, 0, 19, 120, 43, 2, 0, 0, 0, 0], '1853': [0, 0, 19, 121, 42, 2, 0, 0, 0, 0], '1854': [1, 0, 19, 119, 41, 3, 1, 0, 0, 0], '1855': [0, 0, 19, 121, 41, 3, 0, 0, 0, 0], '1856': [0, 1, 19, 120, 41, 3, 0, 0, 0, 0], '1857': [0, 0, 19, 120, 44, 1, 0, 0, 0, 0], '1858': [0, 0, 19, 120, 44, 0, 1, 0, 0, 0], '1859': [0, 0, 19, 122, 40, 3, 0, 0, 0, 0], '1860': [0, 0, 20, 120, 38, 6, 0, 0, 0, 0], '1861': [0, 0, 19, 121, 41, 3, 0, 0, 0, 0], '1862': [0, 0, 20, 121, 39, 4, 0, 0, 0, 0], '1863': [0, 0, 19, 123, 39, 3, 0, 0, 0, 0], '1864': [0, 0, 20, 120, 42, 2, 0, 0, 0, 0], '1865': [0, 0, 22, 119, 41, 2, 0, 0, 0, 0], '1866': [0, 0, 22, 122, 37, 3, 0, 0, 0, 0], '1867': [1, 0, 23, 116, 39, 5, 0, 0, 0, 0], '1868': [1, 3, 21, 115, 40, 4, 0, 0, 0, 0], '1869': [0, 1, 21, 118, 41, 3, 0, 0, 0, 0], '1870': [0, 0, 22, 116, 42, 4, 0, 0, 0, 0], '1871': [0, 0, 21, 117, 41, 5, 0, 0, 0, 0], '1872': [0, 0, 23, 114, 40, 7, 0, 0, 0, 0], '1873': [0, 0, 21, 116, 41, 6, 0, 0, 0, 0], '1874': [0, 0, 21, 116, 41, 6, 0, 0, 0, 0], '1875': [1, 0, 21, 114, 43, 5, 0, 0, 0, 0], '1876': [0, 0, 21, 115, 40, 8, 0, 0, 0, 0], '1877': [0, 0, 20, 116, 39, 9, 0, 0, 0, 0], '1878': [0, 0, 21, 113, 42, 7, 1, 0, 0, 0], '1879': [0, 0, 20, 116, 39, 8, 1, 0, 0, 0], '1880': [0, 0, 20, 116, 41, 6, 1, 0, 0, 0], '1881': [0, 0, 18, 118, 39, 9, 0, 0, 0, 0], '1882': [0, 0, 18, 116, 40, 10, 0, 0, 0, 0], '1883': [0, 0, 17, 115, 42, 10, 0, 0, 0, 0], '1884': [0, 0, 16, 114, 45, 9, 0, 0, 0, 0], '1885': [0, 0, 14, 116, 43, 10, 1, 0, 0, 0], '1886': [0, 0, 14, 116, 42, 11, 1, 0, 0, 0], '1887': [0, 0, 13, 117, 40, 12, 2, 0, 0, 0], '1888': [0, 1, 13, 116, 39, 14, 1, 0, 0, 0], '1889': [1, 0, 13, 115, 39, 14, 2, 0, 0, 0], '1890': [2, 0, 13, 113, 41, 15, 0, 0, 0, 0], '1891': [1, 0, 15, 111, 41, 15, 1, 0, 0, 0], '1892': [0, 1, 16, 112, 38, 16, 1, 0, 0, 0], '1893': [1, 0, 16, 112, 36, 16, 3, 0, 0, 0], '1894': [0, 0, 15, 114, 36, 18, 1, 0, 0, 0], '1895': [0, 0, 15, 114, 36, 16, 3, 0, 0, 0], '1896': [0, 0, 13, 116, 35, 16, 4, 0, 0, 0], '1897': [0, 0, 12, 115, 36, 18, 3, 0, 0, 0], '1898': [0, 0, 13, 114, 37, 17, 3, 0, 0, 0], '1899': [0, 0, 16, 108, 39, 20, 1, 0, 0, 0], '1900': [0, 0, 15, 108, 42, 16, 3, 0, 0, 0], '1901': [0, 0, 15, 108, 40, 17, 4, 0, 0, 0], '1902': [0, 1, 13, 108, 39, 19, 4, 0, 0, 0], '1903': [0, 0, 15, 107, 37, 20, 5, 0, 0, 0], '1904': [1, 0, 13, 106, 39, 20, 5, 0, 0, 0], '1905': [0, 1, 13, 105, 40, 19, 6, 0, 0, 0], '1906': [0, 0, 15, 104, 39, 19, 7, 0, 0, 0], '1907': [0, 0, 14, 105, 38, 17, 10, 0, 0, 0], '1908': [0, 0, 15, 103, 38, 17, 11, 0, 0, 0], '1909': [0, 0, 13, 105, 38, 16, 12, 0, 0, 0], '1910': [0, 0, 12, 105, 37, 16, 14, 0, 0, 0], '1911': [0, 0, 12, 102, 39, 19, 12, 0, 0, 0], '1912': [0, 0, 12, 100, 40, 18, 14, 0, 0, 0], '1913': [0, 0, 11, 105, 37, 17, 14, 0, 0, 0], '1914': [0, 0, 12, 106, 37, 17, 12, 0, 0, 0], '1915': [1, 1, 10, 104, 43, 13, 12, 0, 0, 0], '1916': [0, 0, 12, 105, 41, 15, 11, 0, 0, 0], '1917': [0, 0, 16, 103, 39, 15, 11, 0, 0, 0], '1918': [9, 56, 52, 44, 10, 10, 3, 0, 0, 0], '1919': [0, 1, 17, 97, 42, 15, 11, 1, 0, 0], '1920': [0, 3, 13, 98, 39, 14, 16, 1, 0, 0], '1921': [0, 1, 16, 96, 39, 12, 15, 5, 0, 0], '1922': [0, 1, 14, 92, 43, 12, 17, 5, 0, 0], '1923': [0, 0, 8, 97, 44, 11, 17, 7, 0, 0], '1924': [0, 0, 7, 91, 50, 12, 18, 6, 0, 0], '1925': [0, 0, 8, 88, 53, 10, 18, 7, 0, 0], '1926': [0, 0, 9, 81, 57, 12, 17, 8, 0, 0], '1927': [0, 0, 10, 78, 57, 14, 17, 8, 0, 0], '1928': [0, 0, 8, 77, 58, 15, 17, 9, 0, 0], '1929': [0, 0, 8, 77, 56, 16, 19, 8, 0, 0], '1930': [0, 0, 6, 74, 60, 17, 16, 11, 0, 0], '1931': [0, 1, 8, 74, 52, 22, 15, 12, 0, 0], '1932': [1, 0, 10, 70, 51, 23, 17, 12, 0, 0], '1933': [2, 4, 8, 64, 53, 23, 18, 12, 0, 0], '1934': [0, 0, 4, 64, 61, 24, 17, 14, 0, 0], '1935': [0, 0, 1, 62, 62, 27, 18, 14, 0, 0], '1936': [0, 0, 2, 60, 59, 31, 18, 14, 0, 0], '1937': [0, 0, 1, 58, 59, 34, 16, 16, 0, 0], '1938': [0, 0, 1, 52, 60, 37, 18, 16, 0, 0], '1939': [0, 0, 1, 50, 59, 38, 19, 16, 1, 0], '1940': [0, 0, 1, 50, 59, 37, 23, 14, 0, 0], '1941': [0, 1, 4, 59, 59, 30, 18, 13, 0, 0], '1942': [0, 1, 10, 55, 56, 25, 24, 12, 1, 0], '1943': [0, 2, 13, 48, 58, 30, 18, 14, 1, 0], '1944': [0, 2, 9, 58, 56, 27, 18, 12, 2, 0], '1945': [0, 2, 2, 46, 62, 34, 24, 9, 5, 0], '1946': [0, 0, 2, 26, 58, 41, 36, 15, 6, 0], '1947': [0, 1, 2, 17, 68, 36, 35, 18, 7, 0], '1948': [0, 0, 1, 13, 62, 36, 43, 21, 8, 0], '1949': [0, 0, 1, 9, 57, 36, 46, 24, 11, 0], '1950': [0, 0, 1, 7, 49, 39, 45, 32, 11, 0], '1951': [0, 0, 1, 8, 48, 38, 42, 36, 11, 0], '1952': [0, 0, 1, 7, 46, 40, 42, 35, 13, 0], '1953': [0, 0, 0, 5, 45, 42, 39, 36, 17, 0], '1954': [0, 0, 0, 4, 42, 44, 37, 39, 18, 0], '1955': [0, 0, 0, 4, 38, 43, 41, 39, 19, 0], '1956': [0, 0, 0, 3, 35, 47, 39, 40, 20, 0], '1957': [0, 0, 0, 4, 30, 46, 39, 44, 21, 0], '1958': [0, 0, 0, 4, 25, 46, 41, 41, 27, 0], '1959': [0, 0, 0, 3, 27, 43, 37, 45, 29, 0], '1960': [0, 0, 0, 4, 24, 44, 33, 44, 35, 0], '1961': [0, 0, 0, 3, 22, 40, 40, 41, 38, 0], '1962': [0, 0, 0, 1, 18, 43, 41, 43, 38, 0], '1963': [0, 0, 0, 1, 14, 43, 40, 44, 42, 0], '1964': [0, 0, 0, 0, 12, 43, 39, 48, 42, 0], '1965': [0, 0, 0, 0, 12, 41, 38, 50, 43, 0], '1966': [0, 0, 0, 0, 10, 42, 37, 51, 44, 0], '1967': [0, 0, 0, 0, 8, 42, 36, 51, 47, 0], '1968': [0, 0, 0, 0, 7, 41, 38, 50, 48, 0], '1969': [0, 0, 0, 0, 6, 39, 37, 52, 50, 0], '1970': [0, 0, 0, 0, 5, 37, 39, 55, 50, 1], '1971': [0, 0, 0, 0, 3, 35, 41, 51, 56, 1], '1972': [0, 0, 1, 0, 3, 32, 41, 52, 57, 1], '1973': [0, 0, 0, 0, 4, 29, 42, 53, 58, 1], '1974': [0, 0, 0, 0, 1, 30, 42, 47, 66, 1], '1975': [0, 0, 1, 0, 1, 26, 40, 50, 68, 1], '1976': [0, 0, 1, 0, 2, 28, 38, 48, 69, 1], '1977': [0, 0, 1, 0, 0, 26, 37, 47, 74, 2], '1978': [0, 0, 1, 0, 1, 23, 37, 46, 76, 3], '1979': [0, 0, 1, 0, 0, 21, 39, 45, 77, 4], '1980': [0, 0, 0, 0, 0, 22, 37, 46, 77, 5], '1981': [0, 0, 0, 0, 0, 22, 38, 42, 78, 7], '1982': [0, 0, 0, 0, 0, 23, 34, 44, 76, 10], '1983': [0, 0, 0, 0, 2, 17, 34, 45, 79, 10], '1984': [0, 0, 0, 0, 2, 17, 32, 46, 80, 10], '1985': [0, 0, 0, 0, 1, 18, 32, 40, 85, 11], '1986': [0, 0, 0, 0, 0, 17, 33, 40, 83, 14], '1987': [0, 0, 0, 0, 0, 17, 32, 39, 85, 14], '1988': [0, 0, 0, 0, 0, 16, 34, 36, 87, 14], '1989': [0, 0, 0, 0, 0, 15, 32, 37, 89, 14], '1990': [0, 0, 0, 0, 0, 16, 30, 36, 90, 15], '1991': [0, 0, 0, 0, 0, 16, 29, 36, 85, 21], '1992': [0, 0, 0, 0, 0, 15, 27, 39, 84, 22], '1993': [0, 0, 0, 0, 1, 13, 26, 42, 80, 25], '1994': [0, 1, 0, 0, 0, 13, 27, 42, 79, 25], '1995': [0, 0, 0, 0, 0, 13, 28, 42, 78, 26], '1996': [0, 0, 0, 0, 0, 11, 32, 38, 78, 28], '1997': [0, 0, 0, 0, 0, 13, 31, 36, 77, 30], '1998': [0, 0, 0, 0, 0, 12, 30, 37, 76, 32], '1999': [0, 0, 0, 0, 0, 12, 32, 35, 73, 35], '2000': [0, 0, 0, 0, 0, 11, 31, 36, 72, 37], '2001': [0, 0, 0, 0, 0, 10, 32, 34, 73, 38], '2002': [0, 0, 0, 0, 0, 9, 32, 34, 73, 39], '2003': [0, 0, 0, 0, 0, 9, 30, 35, 73, 40], '2004': [0, 0, 0, 0, 0, 7, 31, 36, 70, 43], '2005': [0, 0, 0, 0, 1, 6, 30, 36, 67, 47], '2006': [0, 0, 0, 0, 0, 7, 29, 34, 68, 49], '2007': [0, 0, 0, 0, 0, 6, 28, 34, 68, 51], '2008': [0, 0, 0, 0, 0, 6, 25, 36, 66, 54], '2009': [0, 0, 0, 0, 0, 5, 23, 35, 66, 58], '2010': [0, 0, 0, 1, 0, 4, 22, 35, 63, 62], '2011': [0, 0, 0, 0, 0, 3, 20, 38, 61, 65], '2012': [0, 0, 0, 0, 0, 3, 18, 38, 62, 66], '2013': [0, 0, 0, 0, 0, 2, 15, 40, 63, 67], '2014': [0, 0, 0, 0, 0, 2, 14, 41, 62, 68], '2015': [0, 0, 0, 0, 0, 2, 11, 43, 63, 68], '2016': [0, 0, 0, 0, 0, 2, 6, 44, 65, 70], '2017': [0, 0, 0, 0, 0, 2, 4, 43, 65, 70], '2018': [0, 0, 0, 0, 0, 0, 5, 44, 61, 74]}  # HISTS[time] = [counts...]

X_LABEL = None
Y_LABEL = None
SHOW_AXIS_LABELS = True

CREATION_TIME = 2.0
PER_STEP_TIME = 0.12844036697247707

def make_chart(counts: list[int]) -> BarChart:
    y_max = 140
    chart = BarChart(
        values=counts,
        bar_names=BIN_LABELS,
        y_range=[0, y_max, max(1, y_max // 5)],
        y_length=4.0,
        x_length=8.0,
        bar_width=0.6,
    )
    if SHOW_AXIS_LABELS:
        chart.x_axis.label = Text(X_LABEL).scale(0.5)
        chart.y_axis.label = Text(Y_LABEL).scale(0.5)
        chart.x_axis.label.next_to(chart.x_axis, DOWN, buff=0.3)
        chart.y_axis.label.next_to(chart.y_axis, LEFT, buff=0.3)
        chart.add(chart.x_axis.label, chart.y_axis.label)
    return chart

class GenScene(Scene):
    def construct(self):
        if not TIMES:
            self.play(Write(Text("No data")))
            return

        t0 = TIMES[0]
        chart = make_chart(HISTS.get(t0, [0]*len(BIN_LABELS)))
        title = Text(str(t0), font_size=36, color=PURPLE_E).to_corner(UL, buff=0.6)

        self.play(FadeIn(chart), run_time=CREATION_TIME * 0.6)
        self.play(FadeIn(title), run_time=CREATION_TIME * 0.4)

        for ti in range(1, len(TIMES)):
            t = TIMES[ti]
            new_chart = make_chart(HISTS.get(t, [0]*len(BIN_LABELS)))
            new_title = Text(str(t), font_size=36, color=PURPLE_E).to_corner(UL, buff=0.6)

            # Align positions to improve Transform quality
            new_chart.move_to(chart.get_center())
            self.play(Transform(chart, new_chart), run_time=PER_STEP_TIME * 0.8)
            self.play(Transform(title, new_title), run_time=PER_STEP_TIME * 0.2)

        self.wait(0.5)
